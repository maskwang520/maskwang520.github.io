<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>Cookie和Session | Maskwang blogs</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="1. Cookie概述HTTP cookie（网络cookie，浏览器cookie）是服务器发送给用户网络浏览器的一小部分数据。 浏览器可以存储它，并将下一个请求发回给同一台服务器。 通常，它用于判断两个请求是否来自同一浏览器 - 例如，保持用户登录。 它记住无状态HTTP协议的有状态信息。Cookie的用途:  回话管理记录登录，购物车，游戏分数或服务器应记住的任何其他内容 个性化用户偏好，主题">
<meta name="keywords" content="Cookie&amp;Session">
<meta property="og:type" content="article">
<meta property="og:title" content="Cookie和Session">
<meta property="og:url" content="http://yoursite.com/2018/05/10/Cookie和Session/index.html">
<meta property="og:site_name" content="Maskwang blogs">
<meta property="og:description" content="1. Cookie概述HTTP cookie（网络cookie，浏览器cookie）是服务器发送给用户网络浏览器的一小部分数据。 浏览器可以存储它，并将下一个请求发回给同一台服务器。 通常，它用于判断两个请求是否来自同一浏览器 - 例如，保持用户登录。 它记住无状态HTTP协议的有状态信息。Cookie的用途:  回话管理记录登录，购物车，游戏分数或服务器应记住的任何其他内容 个性化用户偏好，主题">
<meta property="og:locale" content="zh-Hans">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5281821-9f79ddbe090a7597.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5281821-9c6d6336f83392de.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5281821-599ca8dba3c276f6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5281821-bac0f4f3c7284d96.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5281821-3e0c3b86209d3456.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5281821-26fe10de07d66ebe.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:image" content="https://upload-images.jianshu.io/upload_images/5281821-895721288aba0ded.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
<meta property="og:updated_time" content="2018-05-10T15:36:53.009Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Cookie和Session">
<meta name="twitter:description" content="1. Cookie概述HTTP cookie（网络cookie，浏览器cookie）是服务器发送给用户网络浏览器的一小部分数据。 浏览器可以存储它，并将下一个请求发回给同一台服务器。 通常，它用于判断两个请求是否来自同一浏览器 - 例如，保持用户登录。 它记住无状态HTTP协议的有状态信息。Cookie的用途:  回话管理记录登录，购物车，游戏分数或服务器应记住的任何其他内容 个性化用户偏好，主题">
<meta name="twitter:image" content="https://upload-images.jianshu.io/upload_images/5281821-9f79ddbe090a7597.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240">
  
    <link rel="alternate" href="/atom.xml" title="Maskwang blogs" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Maskwang blogs</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">Talk is nothing,Show me the code</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Zoeken"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-Cookie和Session" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2018/05/10/Cookie和Session/" class="article-date">
  <time datetime="2018-05-10T15:22:26.000Z" itemprop="datePublished">2018-05-10</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Cookie和Session
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h5 id="1-Cookie概述"><a href="#1-Cookie概述" class="headerlink" title="1. Cookie概述"></a>1. Cookie概述</h5><p>HTTP cookie（网络cookie，浏览器cookie）是服务器发送给用户网络浏览器的一小部分数据。 浏览器可以存储它，并将下一个请求发回给同一台服务器。 通常，它用于判断两个请求是否来自同一浏览器 - 例如，保持用户登录。 它记住无状态HTTP协议的有状态信息。<br>Cookie的用途:</p>
<ul>
<li>回话管理<br>记录登录，购物车，游戏分数或服务器应记住的任何其他内容</li>
<li>个性化<br>用户偏好，主题和其他设置</li>
<li>追踪<br>记录和分析用户行为</li>
</ul>
<a id="more"></a>
<h5 id="2-如何创建Cookie"><a href="#2-如何创建Cookie" class="headerlink" title="2. 如何创建Cookie"></a>2. 如何创建Cookie</h5><p>当收到一个HTTP请求时，服务器可以发送带响应的Set-Cookie头。 Cookie通常由浏览器存储，然后将cookie发送到Cookie HTTP标头中的同一服务器。 可以指定到期日期或持续时间，之后不再发送cookie。 此外，可以设置对特定域和路径的限制，限制cookie的发送位置。</p>
<p>Set-Cookie HTTP响应头将来自服务器的cookie发送给用户代理。 一个简单的cookie就像下面这样设置：<br><img src="https://upload-images.jianshu.io/upload_images/5281821-9f79ddbe090a7597.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"><br>完整的响应头如下<br><img src="https://upload-images.jianshu.io/upload_images/5281821-9c6d6336f83392de.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<p>设置Cookie后,每次请求都会带上设置的Cookie,请求如下:<br><img src="https://upload-images.jianshu.io/upload_images/5281821-599ca8dba3c276f6.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<h5 id="3-会话Cookie和持久性Cookie"><a href="#3-会话Cookie和持久性Cookie" class="headerlink" title="3. 会话Cookie和持久性Cookie"></a>3. 会话Cookie和持久性Cookie</h5><ul>
<li>没有设置<code>Expires</code> 或者<code>Max-Age</code>,当Client关闭后,Cookie也会消失,不会持久化.</li>
<li>当我们设置<code>Expires</code> 或者<code>Max-Age</code>后,就会被持久化到客户端文件中.通常设置如下</li>
</ul>
<p><img src="https://upload-images.jianshu.io/upload_images/5281821-bac0f4f3c7284d96.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"></p>
<h5 id="4-Cookie的访问控制"><a href="#4-Cookie的访问控制" class="headerlink" title="4. Cookie的访问控制"></a>4. Cookie的访问控制</h5><p>安全Cookie只能通过HTTPS协议通过加密请求发送到服务器。 即使在安全的情况下，敏感信息也不应该存储在cookie中，因为它们本身就不安全，并且该标志不能提供真正的保护。 从Chrome 52和Firefox 52开始，不安全的网站（http：）无法使用Secure指令设置Cookie。<br>为了避免被XSS攻击,我们可以通过设置<code>HttpOnly</code> 头来减轻这种攻击,<code>HttpOnly</code>表明不能通过JavaScript 的Document.cookie API来获取Cookie,而仅仅的发送给服务器.通常设置如下</p>
<p><img src="https://upload-images.jianshu.io/upload_images/5281821-3e0c3b86209d3456.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"><br>控制Cookie的访问范围通过Domain和Path来控制<br><code>Domain=mozilla.org</code> 即表明<code>*.mozilla.org</code>可以访问Cookie<br><code>Path=/docs</code>即表明只能访问<code>/docs/*</code></p>
<h5 id="5-Cookie的安全性"><a href="#5-Cookie的安全性" class="headerlink" title="5. Cookie的安全性"></a>5. Cookie的安全性</h5><p>Cookie通常用于Web应用程序中以识别用户及其已验证的会话，因此窃取cookie可能会导致劫持经过验证的用户会话。窃取cookie的常见方式包括社交工程或利用应用程序中的XSS漏洞。<br><img src="https://upload-images.jianshu.io/upload_images/5281821-26fe10de07d66ebe.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"><br>当其他用户打开带有这个脚本的页面，就会运行这段程序，造成问题。<br>可以采用如下方式解决：</p>
<ul>
<li><code>HttpOnly</code>来禁止使用js获取到Cookie.</li>
<li>对用户的一些比较重要的操作进行验证</li>
<li>对输入进行验证，把用户的输入都文本化</li>
</ul>
<p><strong>另外一种常见的攻击就是CSRF(跨站域请求伪造)</strong><br>试想下这样一种场景，当你登陆某个银行的网站之后，然后有个黑客放了个钓鱼地址，把你诱导到一个新的地址，接下来，页面就会发送下面这个请求，把你的钱转走了。<br><img src="https://upload-images.jianshu.io/upload_images/5281821-895721288aba0ded.png?imageMogr2/auto-orient/strip%7CimageView2/2/w/1240" alt="image.png"><br>防止CSRF的手段有如下几种</p>
<ul>
<li>和XSS一样，对输入进行过滤</li>
<li>对于用户的重要行为一定要进行验证</li>
<li>尽量对重要的cookie信息缩短Cookie的生存时间<h5 id="6-Session"><a href="#6-Session" class="headerlink" title="6. Session"></a>6. Session</h5></li>
</ul>
<p>Session是在服务端保存的一个数据结构，用来跟踪用户的状态，这个数据可以保存在集群、数据库、文件中；通常借助 cookie 本身和后端存储实现的，一种更高级的会话状态实现。session 的运行依赖 session id，而 session id 是存在 cookie 中的，也就是说，如果浏览器禁用了 cookie ，同时 session 也会失效（但是可以通过其它方式实现，比如在 url 中传递 session_id）</p>
<p>服务器会为每一个访问服务器的用户创建一个session对象，并且把session对象的id保存在本地cookie上，只要用户再次访问服务器时，带着session的id，服务器就会匹配用户在服务器上的session，根据session中的数据，还原用户上次的浏览状态或提供其他人性化服务。</p>
<p>通常来说，Session是一种更安全的方式，把信息保存时服务器端。但是它会占用服务器的内存，Session的信息一多，就会对服务器造成压力。</p>
<p><strong>Session的生命周期是服务端设置的时间长短，一段时间没有active，就会失效。</strong></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2018/05/10/Cookie和Session/" data-id="cjmw6phc80001lgork5do9ql1" class="article-share-link">Delen</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/Cookie-Session/">Cookie&Session</a></li></ul>

    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2018/05/10/深入理解Http协议/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Nieuwer</strong>
      <div class="article-nav-title">
        
          深入理解Http协议
        
      </div>
    </a>
  
  
    <a href="/2018/04/16/flink和spark对比/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Ouder</strong>
      <div class="article-nav-title">flink和spark对比(译)</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categorieën</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/DesignPattern/">DesignPattern</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java基础/">Java基础</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Java源码分析/">Java源码分析</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Netty/">Netty</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Redis/">Redis</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Spring/">Spring</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/Springboot/">Springboot</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/flink/">flink</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/netty/">netty</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/中间件比赛/">中间件比赛</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/数据结构与算法/">数据结构与算法</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/计算机网络/">计算机网络</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Labels</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/Cookie-Session/">Cookie&Session</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTTP/">HTTP</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HTTP-2/">HTTP/2</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/HashMap/">HashMap</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Java基础/">Java基础</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Lambada表达式/">Lambada表达式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/LeetCode/">LeetCode</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Netty/">Netty</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Redis/">Redis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Spring/">Spring</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Springboot/">Springboot</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/Zookeeper/">Zookeeper</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/flink/">flink</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/java/">java</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kafka/">kafka</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/netty/">netty</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/springboot/">springboot</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/web/">web</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/websocket/">websocket</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/中间件比赛/">中间件比赛</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/红黑树/">红黑树</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/设计模式/">设计模式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/集合/">集合</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/Cookie-Session/" style="font-size: 10px;">Cookie&Session</a> <a href="/tags/HTTP/" style="font-size: 10px;">HTTP</a> <a href="/tags/HTTP-2/" style="font-size: 12.5px;">HTTP/2</a> <a href="/tags/HashMap/" style="font-size: 10px;">HashMap</a> <a href="/tags/Java基础/" style="font-size: 12.5px;">Java基础</a> <a href="/tags/Lambada表达式/" style="font-size: 10px;">Lambada表达式</a> <a href="/tags/LeetCode/" style="font-size: 12.5px;">LeetCode</a> <a href="/tags/Netty/" style="font-size: 12.5px;">Netty</a> <a href="/tags/Redis/" style="font-size: 10px;">Redis</a> <a href="/tags/Spring/" style="font-size: 12.5px;">Spring</a> <a href="/tags/Springboot/" style="font-size: 10px;">Springboot</a> <a href="/tags/Zookeeper/" style="font-size: 10px;">Zookeeper</a> <a href="/tags/flink/" style="font-size: 15px;">flink</a> <a href="/tags/java/" style="font-size: 20px;">java</a> <a href="/tags/kafka/" style="font-size: 10px;">kafka</a> <a href="/tags/netty/" style="font-size: 12.5px;">netty</a> <a href="/tags/springboot/" style="font-size: 10px;">springboot</a> <a href="/tags/web/" style="font-size: 10px;">web</a> <a href="/tags/websocket/" style="font-size: 10px;">websocket</a> <a href="/tags/中间件比赛/" style="font-size: 10px;">中间件比赛</a> <a href="/tags/红黑树/" style="font-size: 10px;">红黑树</a> <a href="/tags/设计模式/" style="font-size: 17.5px;">设计模式</a> <a href="/tags/集合/" style="font-size: 10px;">集合</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archieven</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/07/">July 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/05/">May 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/12/">December 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/11/">November 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/10/">October 2017</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recente berichten</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/07/28/第四届阿里中间件性能挑战赛总结和思考/">第四届阿里中间件性能挑战赛总结和思考</a>
          </li>
        
          <li>
            <a href="/2018/07/28/Redis面试必备知识点/">Redis面试必备知识点</a>
          </li>
        
          <li>
            <a href="/2018/05/27/Leetcode-Permutations-II/">Leetcode:Permutations II</a>
          </li>
        
          <li>
            <a href="/2018/05/27/LeetCode53-Maximum-Subarray/">LeetCode53. Maximum Subarray</a>
          </li>
        
          <li>
            <a href="/2018/05/13/Netty源码分析系列1-BootStrap的分析/">Netty源码分析系列1:BootStrap的分析</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 Maskwang<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

  </div>
</body>
</html>